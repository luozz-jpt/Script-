-- Carregando a OrionLib
local OrionLib = loadstring(game:HttpGet("https://raw.githubusercontent.com/jensonhirst/Orion/main/source"))()

-- Criando a janela principal com nome "Luiz Hub"
local Window = OrionLib:MakeWindow({
	Name = "Luiz Hub",
	HidePremium = false,
	SaveConfig = true,
	ConfigFolder = "LuizHubConfig"
})

-- Criando uma aba chamada "ESP"
local Tab = Window:MakeTab({
	Name = "ESP",
	Icon = "rbxassetid://4483345998",
	PremiumOnly = false
})

-- Toggle para ligar/desligar o ESP
local espEnabled = false
local highlights = {}

local function addHighlight(character)
	if not character or highlights[character] then return end
	local highlight = Instance.new("Highlight")
	highlight.FillColor = Color3.new(1, 0, 0)
	highlight.OutlineColor = Color3.new(1, 0, 0)
	highlight.FillTransparency = 0.5
	highlight.OutlineTransparency = 0
	highlight.Parent = character
	highlights[character] = highlight
end

local function removeHighlight(character)
	if highlights[character] then
		highlights[character]:Destroy()
		highlights[character] = nil
	end
end

local function updateHighlights()
	for _, player in pairs(game:GetService("Players"):GetPlayers()) do
		if player ~= game:GetService("Players").LocalPlayer and player.Character then
			if espEnabled then
				addHighlight(player.Character)
			else
				removeHighlight(player.Character)
			end
		end
	end

	-- Remove highlights de personagens que saíram
	for character, _ in pairs(highlights) do
		local stillExists = false
		for _, player in pairs(game:GetService("Players"):GetPlayers()) do
			if player.Character == character then
				stillExists = true
				break
			end
		end
		if not stillExists then
			removeHighlight(character)
		end
	end
end

-- Adiciona o toggle à aba
local EspToggle = Tab:AddToggle({
	Name = "ESP Players",
	Default = false,
	Callback = function(value)
		espEnabled = value
		updateHighlights()
	end
})

-- Atualiza o highlight a cada frame enquanto ligado
game:GetService("RunService").RenderStepped:Connect(function()
	if espEnabled then
		updateHighlights()
	end
end)

-- Atualiza quando personagem entra ou respawna
game:GetService("Players").PlayerAdded:Connect(function(player)
	player.CharacterAdded:Connect(function()
		if espEnabled then
			updateHighlights()
		end
	end)
end)

for _, player in pairs(game:GetService("Players"):GetPlayers()) do
	player.CharacterAdded:Connect(function()
		if espEnabled then
			updateHighlights()
		end
	end)
end

-- Inicializa a UI
OrionLib:Init()
